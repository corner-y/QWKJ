<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>审核进度监控台 - 医保审核系统</title>
    <!-- <link rel="stylesheet" href="/1.0/超级管理员/样式文件/unified-sidebar.css">
    <link rel="stylesheet" href="/1.0/样式文件/平台看板样式.css"> -->
    <link rel="stylesheet" href="../../样式文件/通用样式.css">
    <link rel="stylesheet" href="../../样式文件/审核记录样式.css">
    <link rel="stylesheet" href="../../样式文件/unified-sidebar.css">
    <style>
        /* 监控台特定样式 */
        .dashboard-header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .dashboard-title {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        
        .dashboard-subtitle {
            color: #7f8c8d;
            margin-top: 8px;
            font-size: 14px;
        }
        
        .metrics-container {
            padding: 0 20px 20px 20px;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .kpi-card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }
        
        .kpi-title {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .kpi-value {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 4px;
        }
        
        .kpi-unit {
            font-size: 14px;
            color: #95a5a6;
        }
        
        .data-table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .table-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        
        .table-wrapper {
            overflow-x: auto;
        }
        
        .audit-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .audit-table th {
            background: #f8f9fa;
            padding: 16px 24px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .audit-table td {
            padding: 16px 24px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 14px;
            color: #34495e;
        }
        
        .audit-table tr:hover {
            background: #f8f9fa;
        }
        
        .category-row td {
            background: #f1f3f5;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .sub-item td {
            padding-left: 48px;
        }
        
        .drillable {
            color: #3498db;
            text-decoration: underline;
            cursor: pointer;
        }
        
        .drillable:hover {
            color: #2980b9;
        }
        
        .status-completed {
            color: #27ae60;
            font-weight: 500;
        }
        
        .status-running {
            color: #f39c12;
            font-weight: 500;
        }
        
        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-container {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #7f8c8d;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }
        
        .modal-close:hover {
            background: #f1f3f5;
            color: #2c3e50;
        }
        
        .modal-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }
        
        .btn-secondary:hover {
            background: #bdc3c7;
        }
        
        /* 概览信息样式 */
        .overview-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 24px;
        }
        
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }
        
        .overview-item {
            display: flex;
            flex-direction: column;
        }
        
        .overview-label {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 4px;
        }
        
        .overview-value {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        /* 规则详情和病例清单表格样式 */
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .detail-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .detail-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
            color: #34495e;
        }
        
        /* 响应式设计 */
        @media (max-width: 1200px) {
            .kpi-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .dashboard-header, .metrics-container {
                padding: 16px;
            }
            
            .modal-container {
                width: 95%;
                max-height: 95vh;
            }
        }
        
        @media (max-width: 480px) {
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-card {
                padding: 16px;
            }
            
            .kpi-value {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <!-- 引入统一侧边栏 -->
    <div id="sidebar-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-logo">医保审核系统</h2>
                <p class="sidebar-subtitle">超级管理员平台</p>
            </div>
            <div class="sidebar-nav">
                <!-- 侧边栏内容将通过脚本加载 -->
            </div>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <div class="dashboard-header">
            <h1 class="dashboard-title">审核进度监控台</h1>
            <p class="dashboard-subtitle">实时监控每日事后机审工作进度</p>
        </div>

        <div class="metrics-container">
            <!-- KPI卡片区域 -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-title">案例总数</div>
                    <div class="kpi-value">1,254,300</div>
                    <div class="kpi-unit">条</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-title">机审中</div>
                    <div class="kpi-value">254,300</div>
                    <div class="kpi-unit">条</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-title">机审完成</div>
                    <div class="kpi-value">1,000,000</div>
                    <div class="kpi-unit">条</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-title">产生疑点</div>
                    <div class="kpi-value">8,560</div>
                    <div class="kpi-unit">条</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-title">执行失败</div>
                    <div class="kpi-value">128</div>
                    <div class="kpi-unit">条</div>
                </div>
            </div>

            <!-- 数据表格区域 -->
            <div class="data-table-container">
                <div class="table-header">
                    <h2 class="table-title">各审核名目进度</h2>
                </div>
                <div class="table-wrapper">
                    <table class="audit-table">
                        <thead>
                            <tr>
                                <th>审核名目</th>
                                <th>案例总数</th>
                                <th>机审中</th>
                                <th>机审完成</th>
                                <th>产生疑点数</th>
                                <th>执行状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 药品使用类 -->
                            <tr class="category-row">
                                <td>💊 药品使用类</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('过度用药')">过度用药</span></td>
                                <td>150,000</td>
                                <td>0</td>
                                <td>150,000</td>
                                <td>1,200</td>
                                <td class="status-completed">✅ 完成</td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('病药不符')">病药不符</span></td>
                                <td>200,000</td>
                                <td>200,000</td>
                                <td>0</td>
                                <td>-</td>
                                <td class="status-running">🔄 运行中</td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('重复用药')">重复用药</span></td>
                                <td>80,000</td>
                                <td>0</td>
                                <td>80,000</td>
                                <td>650</td>
                                <td class="status-completed">✅ 完成</td>
                            </tr>

                            <!-- 诊疗项目/检查类 -->
                            <tr class="category-row">
                                <td>🩺 诊疗项目/检查类</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('过度检查')">过度检查</span></td>
                                <td>100,000</td>
                                <td>0</td>
                                <td>100,000</td>
                                <td>850</td>
                                <td class="status-completed">✅ 完成</td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('检查类型不匹配')">检查类型不匹配</span></td>
                                <td>120,000</td>
                                <td>54,300</td>
                                <td>65,700</td>
                                <td>-</td>
                                <td class="status-running">🔄 运行中</td>
                            </tr>

                            <!-- 耗材使用类 -->
                            <tr class="category-row">
                                <td>💉 耗材使用类</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('耗材异常使用')">耗材异常使用</span></td>
                                <td>50,000</td>
                                <td>0</td>
                                <td>50,000</td>
                                <td>320</td>
                                <td class="status-completed">✅ 完成</td>
                            </tr>

                            <!-- 住院行为类 -->
                            <tr class="category-row">
                                <td>🏥 住院行为类</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr class="sub-item">
                                <td><span class="drillable" onclick="showRuleDetail('分解住院')">分解住院</span></td>
                                <td>30,000</td>
                                <td>0</td>
                                <td>30,000</td>
                                <td>150</td>
                                <td class="status-completed">✅ 完成</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 规则详情模态框 -->
    <div id="ruleDetailModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">审核名目详情：<span id="detailCategoryName"></span></h2>
                <button class="modal-close" onclick="closeRuleDetailModal()">×</button>
            </div>
            <div class="modal-content">
                <!-- 概览信息 -->
                <div class="overview-info">
                    <div class="overview-grid">
                        <div class="overview-item">
                            <div class="overview-label">总案例数</div>
                            <div class="overview-value" id="totalCases">0</div>
                        </div>
                        <div class="overview-item">
                            <div class="overview-label">机审中</div>
                            <div class="overview-value" id="inProgressCases">0</div>
                        </div>
                        <div class="overview-item">
                            <div class="overview-label">机审完成</div>
                            <div class="overview-value" id="completedCases">0</div>
                        </div>
                        <div class="overview-item">
                            <div class="overview-label">产生疑点数</div>
                            <div class="overview-value" id="totalDoubtPoints">0</div>
                        </div>
                    </div>
                </div>

                <!-- 规则列表 -->
                <h3 style="margin-bottom: 16px; color: #2c3e50;">具体规则列表</h3>
                <div class="table-wrapper">
                    <table class="detail-table">
                        <thead>
                            <tr>
                                <th>规则ID</th>
                                <th>规则名称</th>
                                <th>涉及案例数</th>
                                <th>产生疑点数</th>
                                <th>执行状态</th>
                            </tr>
                        </thead>
                        <tbody id="ruleListBody">
                            <!-- 规则列表将通过JavaScript动态填充 -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRuleDetailModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 案例清单模态框 -->
    <div id="caseListModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">规则详情：<span id="caseRuleName"></span></h2>
                <button class="modal-close" onclick="closeCaseListModal()">×</button>
            </div>
            <div class="modal-content">
                <!-- 规则描述 -->
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #2c3e50; margin-bottom: 8px;">规则描述</h4>
                    <p id="ruleDescription" style="color: #34495e;"></p>
                </div>

                <!-- 病例清单 -->
                <h3 style="margin-bottom: 16px; color: #2c3e50;">触发规则的病例清单</h3>
                <div class="table-wrapper">
                    <table class="detail-table">
                        <thead>
                            <tr>
                                <th>案例ID</th>
                                <th>患者姓名</th>
                                <th>身份证号</th>
                                <th>就诊医院</th>
                                <th>就诊日期</th>
                                <th>违规详情</th>
                            </tr>
                        </thead>
                        <tbody id="caseListBody">
                            <!-- 病例清单将通过JavaScript动态填充 -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCaseListModal()">关闭</button>
            </div>
        </div>
    </div>

    <script>
        // 加载统一侧边栏
        document.addEventListener('DOMContentLoaded', function() {
            // 加载统一侧边栏
            fetch('/1.0/超级管理员/组件/_unified-sidebar.html')
                .then(response => response.text())
                .then(html => {
                    document.querySelector('#sidebar-container .sidebar-nav').innerHTML = html;
                    
                    // 初始化侧边栏
                    if (typeof initSidebar === 'function') {
                        initSidebar();
                    } else {
                        // 如果没有现成的initSidebar函数，使用简单的初始化
                        simpleInitSidebar();
                    }
                })
                .catch(error => {
                    console.error('加载统一侧边栏失败:', error);
                });
        });

        // 简单的侧边栏初始化函数
        function simpleInitSidebar() {
            // 菜单展开/收起功能
            document.querySelectorAll('.nav-expandable').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const parent = this.closest('.nav-group, .nav-subgroup');
                    const submenu = parent.querySelector('.nav-submenu');
                    
                    if (submenu) {
                        parent.classList.toggle('expanded');
                        submenu.style.display = parent.classList.contains('expanded') ? 'block' : 'none';
                    }
                });
            });
        }

        // 模拟规则数据
        const ruleData = {
            '过度用药': {
                totalCases: '150,000',
                inProgressCases: '0',
                completedCases: '150,000',
                totalDoubtPoints: '1,200',
                rules: [
                    { id: 'DR-001', name: '苯磺酸氨氯地平片(5mg) - 30天超量', cases: '8,500', doubtPoints: '450', status: 'completed' },
                    { id: 'DR-002', name: '瑞舒伐他汀钙片(10mg) - 30天超量', cases: '6,200', doubtPoints: '310', status: 'completed' },
                    { id: 'DR-003', name: '胰岛素 - 单次超量', cases: '3,100', doubtPoints: '280', status: 'completed' },
                    { id: 'DR-004', name: '二甲双胍片 - 日剂量超量', cases: '2,800', doubtPoints: '160', status: 'completed' }
                ]
            },
            '重复用药': {
                totalCases: '80,000',
                inProgressCases: '0',
                completedCases: '80,000',
                totalDoubtPoints: '650',
                rules: [
                    { id: 'DR-005', name: '同类降压药重复开具', cases: '5,200', doubtPoints: '250', status: 'completed' },
                    { id: 'DR-006', name: '同类降脂药重复开具', cases: '3,800', doubtPoints: '180', status: 'completed' },
                    { id: 'DR-007', name: '同类抗生素重复开具', cases: '2,500', doubtPoints: '220', status: 'completed' }
                ]
            },
            '过度检查': {
                totalCases: '100,000',
                inProgressCases: '0',
                completedCases: '100,000',
                totalDoubtPoints: '850',
                rules: [
                    { id: 'EX-001', name: 'CT检查频率过高', cases: '6,800', doubtPoints: '320', status: 'completed' },
                    { id: 'EX-002', name: 'MRI检查频率过高', cases: '4,500', doubtPoints: '210', status: 'completed' },
                    { id: 'EX-003', name: '血常规检查过度', cases: '3,200', doubtPoints: '320', status: 'completed' }
                ]
            },
            '耗材异常使用': {
                totalCases: '50,000',
                inProgressCases: '0',
                completedCases: '50,000',
                totalDoubtPoints: '320',
                rules: [
                    { id: 'MC-001', name: '高值耗材使用异常', cases: '3,100', doubtPoints: '150', status: 'completed' },
                    { id: 'MC-002', name: '一次性耗材重复使用', cases: '2,800', doubtPoints: '170', status: 'completed' }
                ]
            },
            '分解住院': {
                totalCases: '30,000',
                inProgressCases: '0',
                completedCases: '30,000',
                totalDoubtPoints: '150',
                rules: [
                    { id: 'IP-001', name: '同一诊断短期多次住院', cases: '2,500', doubtPoints: '150', status: 'completed' }
                ]
            },
            '病药不符': {
                totalCases: '200,000',
                inProgressCases: '200,000',
                completedCases: '0',
                totalDoubtPoints: '-',
                rules: [
                    { id: 'DR-008', name: '高血压患者开具糖尿病药物', cases: '0', doubtPoints: '0', status: 'running' },
                    { id: 'DR-009', name: '糖尿病患者开具高血压药物', cases: '0', doubtPoints: '0', status: 'running' }
                ]
            },
            '检查类型不匹配': {
                totalCases: '120,000',
                inProgressCases: '54,300',
                completedCases: '65,700',
                totalDoubtPoints: '-',
                rules: [
                    { id: 'EX-004', name: '诊断与检查项目不匹配', cases: '32,000', doubtPoints: '0', status: 'running' },
                    { id: 'EX-005', name: '检查项目与治疗方案不匹配', cases: '33,700', doubtPoints: '0', status: 'running' }
                ]
            }
        };

        // 模拟病例数据
        const caseData = {
            'DR-001': {
                description: '检测30天内开具该药品数量 > 35片的就诊记录。',
                cases: [
                    { id: 'CS-001', name: '王*', idCard: '370...01X', hospital: '北京协和医院', date: '2024-10-15', violation: '30天内开具40片' },
                    { id: 'CS-002', name: '李*', idCard: '110...02Y', hospital: '中日友好医院', date: '2024-10-12', violation: '30天内开具50片' },
                    { id: 'CS-003', name: '张*', idCard: '440...03Z', hospital: '北京医院', date: '2024-10-10', violation: '30天内开具45片' },
                    { id: 'CS-004', name: '刘*', idCard: '310...04A', hospital: '协和医院', date: '2024-10-08', violation: '30天内开具38片' },
                    { id: 'CS-005', name: '陈*', idCard: '330...05B', hospital: '北大医院', date: '2024-10-05', violation: '30天内开具42片' }
                ]
            },
            'DR-002': {
                description: '检测30天内开具该药品数量 > 28片的就诊记录。',
                cases: [
                    { id: 'CS-006', name: '赵*', idCard: '320...06C', hospital: '上海第一人民医院', date: '2024-10-14', violation: '30天内开具35片' },
                    { id: 'CS-007', name: '孙*', idCard: '410...07D', hospital: '广州中山医院', date: '2024-10-11', violation: '30天内开具40片' },
                    { id: 'CS-008', name: '周*', idCard: '420...08E', hospital: '武汉同济医院', date: '2024-10-09', violation: '30天内开具32片' }
                ]
            },
            'DR-003': {
                description: '检测单次开具胰岛素剂量超过正常范围的记录。',
                cases: [
                    { id: 'CS-009', name: '吴*', idCard: '510...09F', hospital: '华西医院', date: '2024-10-13', violation: '单次开具超量20%' },
                    { id: 'CS-010', name: '郑*', idCard: '360...10G', hospital: '南昌大学附属医院', date: '2024-10-10', violation: '单次开具超量30%' }
                ]
            }
        };

        // 显示规则详情模态框
        function showRuleDetail(category) {
            const data = ruleData[category];
            if (!data) return;

            // 填充概览信息
            document.getElementById('detailCategoryName').textContent = category;
            document.getElementById('totalCases').textContent = data.totalCases;
            document.getElementById('inProgressCases').textContent = data.inProgressCases;
            document.getElementById('completedCases').textContent = data.completedCases;
            document.getElementById('totalDoubtPoints').textContent = data.totalDoubtPoints;

            // 填充规则列表
            const ruleListBody = document.getElementById('ruleListBody');
            ruleListBody.innerHTML = '';

            data.rules.forEach(rule => {
                const row = document.createElement('tr');
                const statusClass = rule.status === 'completed' ? 'status-completed' : 'status-running';
                const statusText = rule.status === 'completed' ? '✅ 完成' : '🔄 运行中';
                
                row.innerHTML = `
                    <td>${rule.id}</td>
                    <td><span class="drillable" onclick="showCaseList('${rule.id}', '${rule.name}')">${rule.name}</span></td>
                    <td>${rule.cases}</td>
                    <td>${rule.doubtPoints}</td>
                    <td class="${statusClass}">${statusText}</td>
                `;
                
                ruleListBody.appendChild(row);
            });

            // 显示模态框
            document.getElementById('ruleDetailModal').style.display = 'flex';
        }

        // 关闭规则详情模态框
        function closeRuleDetailModal() {
            document.getElementById('ruleDetailModal').style.display = 'none';
        }

        // 显示病例清单模态框
        function showCaseList(ruleId, ruleName) {
            const data = caseData[ruleId];
            if (!data) {
                // 如果没有对应规则的病例数据，使用默认数据
                const defaultData = {
                    description: '该规则的详细描述信息。',
                    cases: [
                        { id: 'CS-N/A', name: '匿名患者', idCard: '***', hospital: '某医院', date: '2024-10-01', violation: '符合该规则条件' }
                    ]
                };
                fillCaseListData(defaultData, ruleName);
            } else {
                fillCaseListData(data, ruleName);
            }
        }

        // 填充病例清单数据
        function fillCaseListData(data, ruleName) {
            // 填充规则名称和描述
            document.getElementById('caseRuleName').textContent = ruleName;
            document.getElementById('ruleDescription').textContent = data.description;

            // 填充病例列表
            const caseListBody = document.getElementById('caseListBody');
            caseListBody.innerHTML = '';

            data.cases.forEach(caseItem => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td><span class="drillable" onclick="openCaseDetail('${caseItem.id}')">${caseItem.id}</span></td>
                    <td>${caseItem.name}</td>
                    <td>${caseItem.idCard}</td>
                    <td>${caseItem.hospital}</td>
                    <td>${caseItem.date}</td>
                    <td>${caseItem.violation}</td>
                `;
                
                caseListBody.appendChild(row);
            });

            // 关闭规则详情模态框，显示病例清单模态框
            document.getElementById('ruleDetailModal').style.display = 'none';
            document.getElementById('caseListModal').style.display = 'flex';
        }

        // 关闭病例清单模态框
        function closeCaseListModal() {
            document.getElementById('caseListModal').style.display = 'none';
        }

        // 打开案例详情页
        function openCaseDetail(caseId) {
            // 关闭所有模态框
            document.getElementById('caseListModal').style.display = 'none';
            
            // 跳转到案例详情页
            window.location.href = `/1.0/超级管理员/事后审核管理/案例详情页.html?caseId=${caseId}`;
        }

        // 点击模态框外部关闭模态框
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>