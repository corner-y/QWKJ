# 统一菜单应用指南

## 概述

本指南说明如何为超级管理员模块的所有页面应用统一的左侧菜单，确保整个系统的导航一致性。

## 已完成的工作

### 1. 创建统一菜单组件
- **文件位置**: `组件/_unified-sidebar.html`
- **样式文件**: `../样式文件/unified-sidebar.css`
- **功能**: 包含完整的三级菜单结构，支持展开/折叠和高亮显示

### 2. 已更新的页面示例
- ✅ `工作台/工作台.html`
- ✅ `规则管理/规则列表/规则管理主页.html`
- ✅ `审核管理/审核流程/事前审核记录.html`
- ✅ `用户权限管理/用户管理/用户列表.html`

## 菜单结构

### 一级菜单
- 工作台
- 规则管理
- 审核管理
- 用户权限管理
- 系统管理

### 二级和三级菜单
```
工作台/
├── 平台运营看板
└── 报告规则分析

规则管理/
├── 规则列表/
│   ├── 规则管理主页
│   ├── 门诊规则管理
│   └── 医保规则管理系统
├── 规则详情/
│   ├── 规则详情
│   ├── 临床规则详情
│   ├── 慢病规则详情
│   ├── 政策规则详情
│   └── 门诊规则详情
└── 规则操作/
    ├── 创建规则
    ├── 编辑规则
    ├── 规则参数配置
    └── 规则管理完整版

审核管理/
├── 审核流程/
│   ├── 事前审核记录
│   ├── 事中审核检查
│   └── 事后审核任务列表
└── 审核结果

用户权限管理/
├── 用户管理
├── 权限管理
└── 组织管理/
    ├── 科室管理
    ├── 租户管理
    ├── 租户表单
    └── 企业详情

系统管理/
├── 全局设置
├── 系统监控
└── 知识库目录
```

## 应用步骤

### 步骤1: 更新CSS引用

根据页面所在目录层级，更新CSS文件路径：

**一级目录页面** (如 `工作台/工作台.html`):
```html
<link rel="stylesheet" href="../样式文件/通用样式.css">
<link rel="stylesheet" href="../样式文件/unified-sidebar.css">
```

**二级目录页面** (如 `用户权限管理/用户管理/用户列表.html`):
```html
<link rel="stylesheet" href="../../../样式文件/通用样式.css">
<link rel="stylesheet" href="../../../样式文件/unified-sidebar.css">
```

**三级目录页面** (如 `规则管理/规则列表/规则管理主页.html`):
```html
<link rel="stylesheet" href="../../../样式文件/通用样式.css">
<link rel="stylesheet" href="../../../样式文件/unified-sidebar.css">
```

### 步骤2: 修改HTML结构

将原有的页面容器包装在新的结构中：

**原结构**:
```html
<body>
    <div class="原有容器类名">
        <!-- 页面内容 -->
    </div>
</body>
```

**新结构**:
```html
<body>
    <div class="dashboard-container">
        <!-- 统一左侧菜单 -->
        <div id="sidebar-container"></div>
        
        <!-- 主内容区域 -->
        <div class="main-content">
            <div class="原有容器类名">
                <!-- 页面内容 -->
            </div>
        </div>
    </div>
</body>
```

### 步骤3: 添加菜单加载脚本

在页面底部添加以下脚本（在 `</body>` 标签前）：

```html
<!-- 加载统一菜单 -->
<script>
    // 加载统一菜单组件
    fetch('相对路径/组件/_unified-sidebar.html')
        .then(response => response.text())
        .then(html => {
            document.getElementById('sidebar-container').innerHTML = html;
            // 设置当前页面菜单高亮
            const currentMenuItem = document.querySelector('[data-menu="页面标识"]');
            if (currentMenuItem) {
                currentMenuItem.classList.add('active');
                // 展开父级菜单组
                let parent = currentMenuItem.closest('.nav-group, .nav-subgroup');
                while (parent) {
                    parent.classList.add('expanded');
                    const submenu = parent.querySelector('.nav-submenu');
                    if (submenu) {
                        submenu.style.display = 'block';
                    }
                    parent = parent.parentElement.closest('.nav-group, .nav-subgroup');
                }
            }
        })
        .catch(error => console.error('Error loading sidebar:', error));
</script>
```

## 页面标识映射表

| 页面路径 | data-menu 标识 | 目录层级 |
|---------|---------------|----------|
| 工作台/工作台.html | dashboard | 2 |
| 工作台/平台运营看板.html | dashboard-overview | 2 |
| 工作台/报告规则分析.html | dashboard-analysis | 2 |
| 规则管理/规则列表/规则管理主页.html | rules-main | 3 |
| 规则管理/规则列表/门诊规则管理.html | rules-outpatient | 3 |
| 规则管理/规则列表/医保规则管理系统v2.html | rules-medical | 3 |
| 规则管理/规则详情/规则详情.html | rules-detail-general | 3 |
| 规则管理/规则详情/临床规则详情.html | rules-detail-clinical | 3 |
| 规则管理/规则详情/慢病规则详情.html | rules-detail-chronic | 3 |
| 规则管理/规则详情/政策规则详情.html | rules-detail-policy | 3 |
| 规则管理/规则详情/门诊规则详情.html | rules-detail-outpatient | 3 |
| 规则管理/规则操作/创建规则.html | rules-create | 3 |
| 规则管理/规则操作/编辑规则.html | rules-edit | 3 |
| 规则管理/规则操作/规则参数配置.html | rules-config | 3 |
| 规则管理/规则操作/规则管理完整版.html | rules-full | 3 |
| 审核管理/审核流程/事前审核记录.html | audit-pre | 3 |
| 审核管理/审核流程/事中审核检查.html | audit-during | 3 |
| 审核管理/审核流程/事后审核任务列表.html | audit-post | 3 |
| 审核管理/审核结果/审核结果.html | audit-results | 2 |
| 用户权限管理/用户管理/用户列表.html | user-list | 3 |
| 用户权限管理/权限管理/权限管理.html | permission | 2 |
| 用户权限管理/组织管理/科室管理.html | department | 3 |
| 用户权限管理/组织管理/租户管理.html | tenant | 3 |
| 用户权限管理/组织管理/租户表单.html | tenant-form | 3 |
| 用户权限管理/组织管理/企业详情.html | enterprise | 3 |
| 系统管理/全局设置.html | global-settings | 2 |
| 系统管理/系统监控.html | system-monitor | 2 |
| 系统管理/知识库目录.html | knowledge-base | 2 |

## 相对路径计算

- **2级目录**: `../组件/_unified-sidebar.html`
- **3级目录**: `../../组件/_unified-sidebar.html`

## 批量更新工具

已创建 `脚本文件/update-all-pages.js` 文件，包含所有页面的配置信息和辅助函数，可用于批量更新。

## 注意事项

1. **路径一致性**: 确保CSS和组件的相对路径正确
2. **标识唯一性**: 每个页面的 `data-menu` 标识必须唯一
3. **结构完整性**: 确保添加了正确的闭合标签
4. **测试验证**: 更新后测试菜单展开/折叠和高亮功能

## 验证清单

更新每个页面后，请检查：

- [ ] CSS文件路径正确
- [ ] HTML结构完整（包含 dashboard-container、sidebar-container、main-content）
- [ ] 菜单加载脚本正确
- [ ] data-menu 标识正确
- [ ] 相对路径正确
- [ ] 页面正常显示
- [ ] 菜单功能正常（展开/折叠/高亮）

## 完成状态

当前进度：4/40+ 页面已完成

建议按模块逐步完成：
1. ✅ 工作台模块 (1/2 完成)
2. ✅ 规则管理模块 (1/12 完成) 
3. ✅ 审核管理模块 (1/4 完成)
4. ✅ 用户权限管理模块 (1/7 完成)
5. ⏳ 系统管理模块 (0/3 完成)

按照本指南继续更新剩余页面，确保整个系统的导航一致性。