<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ…¢ç—…æ•°æ®çœ‹æ¿</title>
    <!-- <link rel="stylesheet" href="../../æ ·å¼æ–‡ä»¶/é€šç”¨æ ·å¼.css">
    <link rel="stylesheet" href="../../æ ·å¼æ–‡ä»¶/unified-sidebar.css"> -->
        <link rel="stylesheet" href="../../../æ ·å¼æ–‡ä»¶/é€šç”¨æ ·å¼.css">
    <link rel="stylesheet" href="../../../æ ·å¼æ–‡ä»¶/å®¡æ ¸è®°å½•æ ·å¼.css">
    <link rel="stylesheet" href="../../../æ ·å¼æ–‡ä»¶/unified-sidebar.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* æ…¢ç—…æ•°æ®çœ‹æ¿é¡µé¢æ ·å¼ - ä¸»å®¹å™¨æ ·å¼ */
        .dashboard-container {
            padding: 20px;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden; /* ç¦æ­¢æ°´å¹³æ»šåŠ¨ */
            box-sizing: border-box;
        }

        /* KPIå¡ç‰‡å®¹å™¨æ ·å¼ - å…³é”®ç»©æ•ˆæŒ‡æ ‡å¡ç‰‡ç½‘æ ¼å¸ƒå±€ */
        .kpi-cards {
            display: grid; /* ä½¿ç”¨gridå¸ƒå±€ */
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* è‡ªåŠ¨é€‚åº”åˆ—æ•°ï¼Œæœ€å°å®½åº¦250px */
            gap: 20px; /* å¡ç‰‡é—´è· */
            margin-bottom: 20px; /* åº•éƒ¨è¾¹è·ï¼Œä¸ä¸‹æ–¹å†…å®¹åˆ†éš” */
            width: 100%; /* å®½åº¦100%ï¼Œå¡«æ»¡çˆ¶å®¹å™¨ */
        }

        /* å›¾è¡¨åŒºåŸŸæ ·å¼ - ç¡®ä¿å›¾è¡¨å®¹å™¨å æ»¡ç©ºé—´ */
        .chart-section {
            background-color: var(--bg-primary); /* ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² */
            border-radius: var(--radius-medium); /* ä½¿ç”¨ä¸»é¢˜ä¸­ç­‰åœ†è§’ */
            box-shadow: var(--shadow-light); /* ä½¿ç”¨ä¸»é¢˜è½»å¾®é˜´å½± */
            padding: 20px; /* å†…è¾¹è· */
            margin-bottom: 20px; /* åº•éƒ¨è¾¹è·ï¼Œä¸ä¸‹æ–¹å†…å®¹åˆ†éš” */
            width: 100%; /* å®½åº¦100%ï¼Œå¡«æ»¡çˆ¶å®¹å™¨ */
        }

        /* å›¾è¡¨å®¹å™¨æ ·å¼ - ç”¨äºChart.jså›¾è¡¨çš„å®¹å™¨ */
        .chart-container {
            position: relative; /* ç›¸å¯¹å®šä½ï¼Œä¸ºå­å…ƒç´ æä¾›å®šä½åŸºå‡† */
            height: 300px; /* å›ºå®šé«˜åº¦ï¼Œç¡®ä¿å›¾è¡¨æ˜¾ç¤ºæ­£å¸¸ */
            width: 100%; /* å®½åº¦100%ï¼Œå¡«æ»¡çˆ¶å®¹å™¨ */
        }
        
        /* é¡µé¢å¤´éƒ¨æ ·å¼ - æ ‡é¢˜å’Œç­›é€‰å™¨åŒºåŸŸ */
        .page-header {
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-bottom: 20px; /* åº•éƒ¨è¾¹è·ï¼Œä¸ä¸‹æ–¹å†…å®¹åˆ†éš” */
        }
        
        .page-header h2 {
            margin: 0; /* é‡ç½®é»˜è®¤margin */
            color: var(--text-primary); /* ä½¿ç”¨ä¸»é¢˜ä¸»æ–‡æœ¬é¢œè‰² */
        }
        
        /* æ—¥æœŸç­›é€‰å™¨æ ·å¼ - æ—¥æœŸé€‰æ‹©åŒºåŸŸ */
        .date-filter {
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 16px; /* å…ƒç´ é—´è· */
        }
        
        /* æ—¥æœŸé€‰æ‹©å™¨æ ·å¼ - å•ä¸ªæ—¥æœŸé€‰æ‹©ç»„ä»¶ */
        .date-selector {
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 8px; /* å…ƒç´ é—´è· */
        }
        
        .date-selector label {
            color: var(--text-secondary); /* ä½¿ç”¨ä¸»é¢˜æ¬¡è¦æ–‡æœ¬é¢œè‰² */
            font-size: var(--font-size-sm); /* ä½¿ç”¨ä¸»é¢˜å°å­—ä½“ */
        }
        
        .date-selector select {
            padding: 4px 8px; /* å†…è¾¹è· */
            border: 1px solid var(--border-color); /* ä½¿ç”¨ä¸»é¢˜è¾¹æ¡†é¢œè‰² */
            border-radius: var(--radius-small); /* ä½¿ç”¨ä¸»é¢˜å°åœ†è§’ */
            background-color: var(--bg-primary); /* ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² */
            color: var(--text-primary); /* ä½¿ç”¨ä¸»é¢˜ä¸»æ–‡æœ¬é¢œè‰² */
        }
        
        /* KPIå¡ç‰‡æ ·å¼ - å•ä¸ªå…³é”®ç»©æ•ˆæŒ‡æ ‡å¡ç‰‡ */
        .kpi-card {
            background-color: var(--bg-primary); /* ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² */
            border-radius: var(--radius-medium); /* ä½¿ç”¨ä¸»é¢˜ä¸­ç­‰åœ†è§’ */
            box-shadow: var(--shadow-light); /* ä½¿ç”¨ä¸»é¢˜è½»å¾®é˜´å½± */
            padding: 20px; /* å†…è¾¹è· */
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 16px; /* å…ƒç´ é—´è· */
            border-left: 4px solid var(--primary-color); /* å·¦ä¾§è¾¹æ¡†ï¼ŒåŒºåˆ†ä¸åŒç±»å‹çš„å¡ç‰‡ */
        }
        
        .kpi-card.total {
            border-left-color: var(--primary-color); /* æ€»æ•°å¡ç‰‡ä½¿ç”¨ä¸»é¢˜ä¸»è¦é¢œè‰² */
        }
        
        .kpi-card.pending {
            border-left-color: var(--warning-color); /* å¾…å¤„ç†å¡ç‰‡ä½¿ç”¨ä¸»é¢˜è­¦å‘Šé¢œè‰² */
        }
        
        .kpi-card.pass-rate {
            border-left-color: var(--success-color); /* é€šè¿‡ç‡å¡ç‰‡ä½¿ç”¨ä¸»é¢˜æˆåŠŸé¢œè‰² */
        }
        
        .kpi-card.average-time {
            border-left-color: var(--info-color); /* å¹³å‡æ—¶é—´å¡ç‰‡ä½¿ç”¨ä¸»é¢˜ä¿¡æ¯é¢œè‰² */
        }
        
        /* KPIå›¾æ ‡æ ·å¼ - å¡ç‰‡å†…çš„å›¾æ ‡å®¹å™¨ */
        .kpi-icon {
            width: 48px; /* å›ºå®šå®½åº¦ */
            height: 48px; /* å›ºå®šé«˜åº¦ */
            border-radius: 50%; /* åœ†å½¢å›¾æ ‡ */
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            font-size: 24px; /* å›¾æ ‡å­—ä½“å¤§å° */
            background-color: var(--primary-light); /* ä½¿ç”¨ä¸»é¢˜ä¸»è¦æµ…è‰²èƒŒæ™¯ */
            color: var(--primary-color); /* ä½¿ç”¨ä¸»é¢˜ä¸»è¦é¢œè‰² */
        }
        
        /* ä¸åŒç±»å‹KPIå¡ç‰‡çš„å›¾æ ‡é¢œè‰² */
        .kpi-card.pending .kpi-icon {
            background-color: var(--warning-light); /* å¾…å¤„ç†å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜è­¦å‘Šæµ…è‰²èƒŒæ™¯ */
            color: var(--warning-color); /* å¾…å¤„ç†å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜è­¦å‘Šé¢œè‰² */
        }
        
        .kpi-card.pass-rate .kpi-icon {
            background-color: var(--success-light); /* é€šè¿‡ç‡å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜æˆåŠŸæµ…è‰²èƒŒæ™¯ */
            color: var(--success-color); /* é€šè¿‡ç‡å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜æˆåŠŸé¢œè‰² */
        }
        
        .kpi-card.average-time .kpi-icon {
            background-color: var(--info-light); /* å¹³å‡æ—¶é—´å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜ä¿¡æ¯æµ…è‰²èƒŒæ™¯ */
            color: var(--info-color); /* å¹³å‡æ—¶é—´å¡ç‰‡å›¾æ ‡ä½¿ç”¨ä¸»é¢˜ä¿¡æ¯é¢œè‰² */
        }
        
        /* KPIå†…å®¹åŒºåŸŸæ ·å¼ */
        .kpi-content {
            flex: 1; /* çµæ´»å æ®å‰©ä½™ç©ºé—´ */
        }
        
        .kpi-label {
            font-size: var(--font-size-sm); /* ä½¿ç”¨ä¸»é¢˜å°å­—ä½“ */
            color: var(--text-secondary); /* ä½¿ç”¨ä¸»é¢˜æ¬¡è¦æ–‡æœ¬é¢œè‰² */
            margin-bottom: 4px; /* åº•éƒ¨è¾¹è·ï¼Œä¸æ•°å€¼åˆ†éš” */
        }
        
        .kpi-value {
            font-size: var(--font-size-2xl); /* ä½¿ç”¨ä¸»é¢˜è¶…å¤§å­—ä½“ */
            font-weight: var(--font-weight-bold); /* ä½¿ç”¨ä¸»é¢˜ç²—ä½“å­—é‡ */
            color: var(--text-primary); /* ä½¿ç”¨ä¸»é¢˜ä¸»æ–‡æœ¬é¢œè‰² */
        }
        
        .kpi-change {
            font-size: var(--font-size-xs); /* ä½¿ç”¨ä¸»é¢˜è¶…å°å­—ä½“ */
            color: var(--text-tertiary); /* ä½¿ç”¨ä¸»é¢˜æ¬¡è¦æ–‡æœ¬é¢œè‰² */
            margin-top: 4px; /* é¡¶éƒ¨è¾¹è·ï¼Œä¸æ•°å€¼åˆ†éš” */
        }
        
        /* å›¾è¡¨å®¹å™¨æ ·å¼ - å¤šä¸ªå›¾è¡¨çš„ç½‘æ ¼å¸ƒå±€ */
        .charts-container {
            display: grid; /* ä½¿ç”¨gridå¸ƒå±€ */
            grid-template-columns: 2fr 1fr; /* ä¸¤åˆ—å¸ƒå±€ï¼Œæ¯”ä¾‹2:1 */
            gap: 20px; /* å›¾è¡¨é—´è· */
            margin-bottom: 20px; /* åº•éƒ¨è¾¹è·ï¼Œä¸ä¸‹æ–¹å†…å®¹åˆ†éš” */
        }
        
        /* å›¾è¡¨å¡ç‰‡æ ·å¼ - å•ä¸ªå›¾è¡¨çš„å®¹å™¨ */
        .chart-card {
            background-color: var(--bg-primary); /* ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² */
            border-radius: var(--radius-medium); /* ä½¿ç”¨ä¸»é¢˜ä¸­ç­‰åœ†è§’ */
            box-shadow: var(--shadow-light); /* ä½¿ç”¨ä¸»é¢˜è½»å¾®é˜´å½± */
            padding: 20px; /* å†…è¾¹è· */
        }
        
        /* å›¾è¡¨å¤´éƒ¨æ ·å¼ - å›¾è¡¨æ ‡é¢˜å’Œæ“ä½œæŒ‰é’®åŒºåŸŸ */
        .chart-header {
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-bottom: 20px; /* åº•éƒ¨è¾¹è·ï¼Œä¸å›¾è¡¨å†…å®¹åˆ†éš” */
        }
        
        .chart-title {
            font-size: var(--font-size-lg); /* ä½¿ç”¨ä¸»é¢˜å¤§å­—ä½“ */
            font-weight: var(--font-weight-semibold); /* ä½¿ç”¨ä¸»é¢˜åŠç²—ä½“å­—é‡ */
            color: var(--text-primary); /* ä½¿ç”¨ä¸»é¢˜ä¸»æ–‡æœ¬é¢œè‰² */
        }
        
        /* å›¾è¡¨æ“ä½œæŒ‰é’®ç»„æ ·å¼ */
        .chart-actions {
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            gap: 8px; /* æŒ‰é’®é—´è· */
        }
        
        /* å›¾è¡¨å‘¨æœŸåˆ‡æ¢æŒ‰é’®æ ·å¼ */
        .chart-period-btn {
            padding: 4px 12px; /* å†…è¾¹è· */
            border: 1px solid var(--border-color); /* ä½¿ç”¨ä¸»é¢˜è¾¹æ¡†é¢œè‰² */
            background-color: var(--bg-primary); /* ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² */
            color: var(--text-secondary); /* ä½¿ç”¨ä¸»é¢˜æ¬¡è¦æ–‡æœ¬é¢œè‰² */
            border-radius: var(--radius-small);
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chart-period-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .chart-period-btn:hover:not(.active) {
            background-color: var(--bg-secondary);
        }
        
        .chart-body {
            position: relative;
            height: 300px;
        }
        
        .bottom-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        
        .review-process-chart .chart-body {
            height: 350px;
        }
        
        .hospital-ranking-chart .chart-body {
            height: 350px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ç»Ÿä¸€å·¦ä¾§èœå• -->
        <div id="sidebar-container"></div>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="page-header">
                <h2>æ…¢ç—…æ•°æ®çœ‹æ¿</h2>
                <div class="date-filter">
                    <div class="date-selector">
                        <label for="dateRange">æ—¶é—´èŒƒå›´ï¼š</label>
                        <select id="dateRange" onchange="updateDashboard()">
                            <option value="30">è¿‘30å¤©</option>
                            <option value="90">è¿‘90å¤©</option>
                            <option value="180">è¿‘åŠå¹´</option>
                            <option value="365">è¿‘ä¸€å¹´</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="refreshDashboard()">
                        ğŸš€ åˆ·æ–°
                    </button>
                </div>
            </div>

            <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ -->
            <div class="kpi-cards">
                <div class="kpi-card total">
                    <div class="kpi-icon">ğŸ“‹</div>
                    <div class="kpi-content">
                        <div class="kpi-label">æ€»ç”³è¯·é‡</div>
                        <div class="kpi-value" id="totalApplications">1,284</div>
                        <div class="kpi-change">è¾ƒä¸Šæœˆ <span style="color: var(--success-color);">+12.5%</span></div>
                    </div>
                </div>
                <div class="kpi-card pending">
                    <div class="kpi-icon">â³</div>
                    <div class="kpi-content">
                        <div class="kpi-label">å¾…è¯„å®¡é‡</div>
                        <div class="kpi-value" id="pendingApplications">98</div>
                        <div class="kpi-change">è¾ƒä¸Šæœˆ <span style="color: var(--error-color);">-8.2%</span></div>
                    </div>
                </div>
                <div class="kpi-card pass-rate">
                    <div class="kpi-icon">âœ…</div>
                    <div class="kpi-content">
                        <div class="kpi-label">é€šè¿‡ç‡</div>
                        <div class="kpi-value" id="passRate">76.8%</div>
                        <div class="kpi-change">è¾ƒä¸Šæœˆ <span style="color: var(--success-color);">+2.3%</span></div>
                    </div>
                </div>
                <div class="kpi-card average-time">
                    <div class="kpi-icon">âŒ›</div>
                    <div class="kpi-content">
                        <div class="kpi-label">å¹³å‡è¯„å®¡æ—¶é•¿</div>
                        <div class="kpi-value" id="averageReviewTime">3.2 å¤©</div>
                        <div class="kpi-change">è¾ƒä¸Šæœˆ <span style="color: var(--success-color);">-0.3 å¤©</span></div>
                    </div>
                </div>
            </div>

            <!-- ä¸»è¦å›¾è¡¨åŒºåŸŸ -->
            <div class="charts-container">
                <!-- ç”³æŠ¥è¶‹åŠ¿å›¾è¡¨ -->
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">ç”³æŠ¥è¶‹åŠ¿</div>
                        <div class="chart-actions">
                            <button class="chart-period-btn active" onclick="changeTrendPeriod(7)">è¿‘7å¤©</button>
                            <button class="chart-period-btn" onclick="changeTrendPeriod(30)">è¿‘30å¤©</button>
                            <button class="chart-period-btn" onclick="changeTrendPeriod(90)">è¿‘90å¤©</button>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
                
                <!-- ç—…ç§åˆ†å¸ƒå›¾è¡¨ -->
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">ç—…ç§åˆ†å¸ƒ</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="diseaseDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨å›¾è¡¨åŒºåŸŸ -->
            <div class="bottom-charts">
                <!-- è¯„å®¡æµç¨‹æ•ˆç‡å›¾è¡¨ -->
                <div class="chart-card review-process-chart">
                    <div class="chart-header">
                        <div class="chart-title">è¯„å®¡æµç¨‹æ•ˆç‡</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="reviewProcessChart"></canvas>
                    </div>
                </div>
                
                <!-- åŒ»é™¢ç”³æŠ¥æ’åå›¾è¡¨ -->
                <div class="chart-card hospital-ranking-chart">
                    <div class="chart-header">
                        <div class="chart-title">åŒ»é™¢ç”³æŠ¥æ’å</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="hospitalRankingChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½ç»Ÿä¸€èœå•ç»„ä»¶è„šæœ¬ -->
    <script>
    // åŠ è½½ç»Ÿä¸€èœå•ç»„ä»¶
    fetch('../../ç»„ä»¶/_unified-sidebar.html')
        .then(response => response.text())
        .then(html => {
            const sidebarContainer = document.getElementById('sidebar-container');
            sidebarContainer.innerHTML = html;
            // æ‰‹åŠ¨æ‰§è¡Œæ’å…¥çš„è„šæœ¬
            const scripts = sidebarContainer.querySelectorAll('script');
            scripts.forEach(script => {
                const newScript = document.createElement('script');
                if (script.src) {
                    newScript.src = script.src;
                } else {
                    newScript.textContent = script.textContent;
                }
                document.head.appendChild(newScript);
                script.remove();
            });
            // ç­‰å¾…è„šæœ¬æ‰§è¡Œåå†åˆå§‹åŒ–èœå•
            setTimeout(() => {
                if (typeof initSidebar === 'function') {
                    initSidebar();
                }
            }, 100);
        })
        .catch(error => console.error('Error loading sidebar:', error));
    </script>

    <script>
        // ç”Ÿæˆæ—¥æœŸæ•°ç»„
        function generateDates(days) {
            const dates = [];
            const today = new Date();
            
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                dates.push(date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' }));
            }
            
            return dates;
        }

        // ç”Ÿæˆéšæœºæ•°æ®
        function generateRandomData(count, min, max) {
            return Array.from({ length: count }, () => Math.floor(Math.random() * (max - min + 1)) + min);
        }

        // ç”³æŠ¥è¶‹åŠ¿å›¾è¡¨
        let trendChart;
        function initTrendChart(days = 30) {
            const ctx = document.getElementById('trendChart').getContext('2d');
            const dates = generateDates(days);
            const submittedData = generateRandomData(days, 20, 60);
            const approvedData = submittedData.map(val => Math.floor(val * 0.7));
            
            if (trendChart) {
                trendChart.destroy();
            }
            
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'æäº¤æ•°é‡',
                            data: submittedData,
                            borderColor: 'var(--primary-color)',
                            backgroundColor: 'rgba(0, 123, 255, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'é€šè¿‡æ•°é‡',
                            data: approvedData,
                            borderColor: 'var(--success-color)',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'var(--bg-primary)',
                            titleColor: 'var(--text-primary)',
                            bodyColor: 'var(--text-secondary)',
                            borderColor: 'var(--border-color)',
                            borderWidth: 1,
                            padding: 12,
                            boxPadding: 6
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'var(--border-color-light)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)'
                            }
                        }
                    }
                }
            });
        }

        // ç—…ç§åˆ†å¸ƒå›¾è¡¨
        let diseaseDistributionChart;
        function initDiseaseDistributionChart() {
            const ctx = document.getElementById('diseaseDistributionChart').getContext('2d');
            
            const diseaseData = {
                labels: ['é«˜è¡€å‹å¹¶å‘ç—‡', '2å‹ç³–å°¿ç—…', 'å† å¿ƒç—…', 'è„‘å’ä¸­åé—ç—‡', 'æ…¢æ€§è‚¾è„ç—…'],
                data: [42, 28, 15, 10, 5]
            };
            
            const colors = [
                'var(--primary-color)',
                'var(--warning-color)',
                'var(--success-color)',
                'var(--info-color)',
                'var(--error-color)'
            ];
            
            if (diseaseDistributionChart) {
                diseaseDistributionChart.destroy();
            }
            
            diseaseDistributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: diseaseData.labels,
                    datasets: [{
                        data: diseaseData.data,
                        backgroundColor: colors,
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'var(--text-secondary)',
                                padding: 15,
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            backgroundColor: 'var(--bg-primary)',
                            titleColor: 'var(--text-primary)',
                            bodyColor: 'var(--text-secondary)',
                            borderColor: 'var(--border-color)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // è¯„å®¡æµç¨‹æ•ˆç‡å›¾è¡¨
        let reviewProcessChart;
        function initReviewProcessChart() {
            const ctx = document.getElementById('reviewProcessChart').getContext('2d');
            
            const stages = ['æäº¤ç”³è¯·', 'åˆå®¡', 'ä¸“å®¶è¯„å®¡', 'ç»“æœå…¬ç¤º', 'èµ„æ ¼ç¡®è®¤'];
            const currentMonth = [3.5, 1.2, 4.1, 2.0, 0.8];
            const previousMonth = [3.8, 1.5, 4.5, 2.2, 0.9];
            
            if (reviewProcessChart) {
                reviewProcessChart.destroy();
            }
            
            reviewProcessChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: stages,
                    datasets: [
                        {
                            label: 'æœ¬æœˆå¹³å‡æ—¶é•¿(å¤©)',
                            data: currentMonth,
                            backgroundColor: 'var(--primary-color)',
                            borderRadius: 4
                        },
                        {
                            label: 'ä¸Šæœˆå¹³å‡æ—¶é•¿(å¤©)',
                            data: previousMonth,
                            backgroundColor: 'var(--border-color)',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            backgroundColor: 'var(--bg-primary)',
                            titleColor: 'var(--text-primary)',
                            bodyColor: 'var(--text-secondary)',
                            borderColor: 'var(--border-color)',
                            borderWidth: 1,
                            padding: 12
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'var(--border-color-light)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)'
                            },
                            title: {
                                display: true,
                                text: 'å¹³å‡æ—¶é•¿(å¤©)',
                                color: 'var(--text-secondary)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)'
                            }
                        }
                    }
                }
            });
        }

        // åŒ»é™¢ç”³æŠ¥æ’åå›¾è¡¨
        let hospitalRankingChart;
        function initHospitalRankingChart() {
            const ctx = document.getElementById('hospitalRankingChart').getContext('2d');
            
            const hospitals = ['åŒ—äº¬åå’ŒåŒ»é™¢', 'åŒ—äº¬å¤©å›åŒ»é™¢', 'åŒ—äº¬ä¸­æ—¥å‹å¥½åŒ»é™¢', 'åŒ—äº¬åŒ»é™¢', 'åŒ—äº¬å®‰è´åŒ»é™¢'];
            const applications = [325, 285, 248, 203, 187];
            const passRates = [82, 78, 75, 79, 81];
            
            if (hospitalRankingChart) {
                hospitalRankingChart.destroy();
            }
            
            hospitalRankingChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: hospitals,
                    datasets: [
                        {
                            label: 'ç”³æŠ¥æ•°é‡',
                            data: applications,
                            backgroundColor: 'var(--primary-light)',
                            borderColor: 'var(--primary-color)',
                            borderWidth: 1,
                            borderRadius: 4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'é€šè¿‡ç‡(%)',
                            data: passRates,
                            backgroundColor: 'transparent',
                            borderColor: 'var(--success-color)',
                            borderWidth: 2,
                            pointBackgroundColor: 'var(--success-color)',
                            pointRadius: 4,
                            type: 'line',
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            backgroundColor: 'var(--bg-primary)',
                            titleColor: 'var(--text-primary)',
                            bodyColor: 'var(--text-secondary)',
                            borderColor: 'var(--border-color)',
                            borderWidth: 1,
                            padding: 12
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'var(--border-color-light)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)'
                            },
                            title: {
                                display: true,
                                text: 'ç”³æŠ¥æ•°é‡',
                                color: 'var(--text-secondary)'
                            }
                        },
                        y1: {
                            beginAtZero: true,
                            position: 'right',
                            max: 100,
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            title: {
                                display: true,
                                text: 'é€šè¿‡ç‡(%)',
                                color: 'var(--text-secondary)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'var(--text-tertiary)',
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }

        // æ›´æ–°ç”³æŠ¥è¶‹åŠ¿å›¾è¡¨å‘¨æœŸ
        function changeTrendPeriod(days) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.chart-period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // é‡æ–°åˆå§‹åŒ–å›¾è¡¨
            initTrendChart(days);
        }

        // æ›´æ–°æ•´ä¸ªä»ªè¡¨ç›˜
        function updateDashboard() {
            const dateRange = document.getElementById('dateRange').value;
            // è¿™é‡Œå¯ä»¥æ ¹æ®æ—¥æœŸèŒƒå›´æ›´æ–°æ‰€æœ‰æ•°æ®
            
            // æ¨¡æ‹Ÿæ•°æ®æ›´æ–°æ•ˆæœ
            refreshDashboard();
        }

        // åˆ·æ–°ä»ªè¡¨ç›˜æ•°æ®
        function refreshDashboard() {
            // æ¨¡æ‹ŸåŠ è½½æ•ˆæœ
            const kpiValues = document.querySelectorAll('.kpi-value');
            kpiValues.forEach(element => {
                const originalValue = element.textContent;
                element.textContent = 'åŠ è½½ä¸­...';
                
                setTimeout(() => {
                    element.textContent = originalValue;
                }, 500);
            });
            
            // é‡æ–°åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
            initTrendChart();
            initDiseaseDistributionChart();
            initReviewProcessChart();
            initHospitalRankingChart();
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ä»ªè¡¨ç›˜
        document.addEventListener('DOMContentLoaded', function() {
            initTrendChart();
            initDiseaseDistributionChart();
            initReviewProcessChart();
            initHospitalRankingChart();
        });
    </script>
</body>
</html>