# 统一菜单组件使用规范

## 概述

本文档规范了医保智慧监管平台中统一菜单组件的使用方法，确保所有页面的菜单实现保持一致性，降低维护成本。

## 菜单组件位置

统一菜单组件位于：`/1.0/超级管理员/组件/_unified-sidebar.html`

## 使用方法

### 1. HTML结构

在页面的主容器中添加菜单容器：

```html
<div class="dashboard-container">
    <!-- 统一左侧菜单 -->
    <div id="sidebar-container"></div>
    
    <!-- 主内容区域 -->
    <div class="main-content">
        <div class="content-wrapper">
            <!-- 页面内容 -->
        </div>
    </div>
</div>
```

### 2. CSS样式引用

确保引用统一菜单样式文件：

```html
<link rel="stylesheet" href="../../样式文件/unified-sidebar.css">
```

### 3. JavaScript加载脚本

根据页面所在目录层级，使用正确的相对路径加载菜单组件：

#### 不同目录层级的路径规则：

- **一级目录**（如 `/工作台/`、`/系统管理/`）：使用 `../组件/_unified-sidebar.html`
- **二级目录**（如 `/规则管理/规则列表/`、`/用户权限管理/用户管理/`）：使用 `../../组件/_unified-sidebar.html`
- **三级目录**（如 `/规则管理/规则详情/`、`/审核管理/审核流程/`）：使用 `../../../组件/_unified-sidebar.html`

#### 标准加载脚本模板：

```javascript
<script>
// 加载统一菜单组件
fetch('正确的相对路径/组件/_unified-sidebar.html')
    .then(response => response.text())
    .then(html => {
        const sidebarContainer = document.getElementById('sidebar-container');
        sidebarContainer.innerHTML = html;
        // 手动执行插入的脚本
        const scripts = sidebarContainer.querySelectorAll('script');
        scripts.forEach(script => {
            const newScript = document.createElement('script');
            if (script.src) {
                newScript.src = script.src;
            } else {
                newScript.textContent = script.textContent;
            }
            document.head.appendChild(newScript);
            script.remove();
        });
        // 等待脚本执行后再初始化菜单
        setTimeout(() => {
            if (typeof initSidebar === 'function') {
                initSidebar();
            }
        }, 100);
    })
    .catch(error => console.error('Error loading sidebar:', error));
</script>
```

## 路径示例

### 正确的路径示例：

| 页面位置 | 正确路径 |
|---------|----------|
| `/工作台/平台运营看板.html` | `../组件/_unified-sidebar.html` |
| `/规则管理/规则列表/规则管理主页.html` | `../../组件/_unified-sidebar.html` |
| `/规则管理/规则详情/规则详情.html` | `../../../组件/_unified-sidebar.html` |
| `/用户权限管理/用户管理/用户列表.html` | `../../组件/_unified-sidebar.html` |
| `/审核管理/审核流程/事前审核记录.html` | `../../../组件/_unified-sidebar.html` |

### 常见错误：

❌ **错误**：`./组件/_unified-sidebar.html`（相对于当前目录）
❌ **错误**：`/组件/_unified-sidebar.html`（绝对路径）
❌ **错误**：`组件/_unified-sidebar.html`（缺少相对路径标识）

## 菜单功能特性

### 1. 自动高亮
菜单会根据当前页面URL自动高亮对应的菜单项。

### 2. 展开/折叠
支持多级菜单的展开和折叠功能。

### 3. 响应式设计
在小屏幕设备上自动适配布局。

## 维护指南

### 1. 添加新菜单项
在 `_unified-sidebar.html` 中添加新的菜单项，所有使用该组件的页面会自动更新。

### 2. 修改菜单样式
在 `unified-sidebar.css` 中修改样式，确保所有页面保持一致。

### 3. 调试菜单问题
- 检查控制台是否有404错误
- 验证路径是否正确
- 确认 `sidebar-container` 元素存在

## 最佳实践

1. **统一性**：所有页面必须使用统一菜单组件，不得自定义菜单结构
2. **路径准确性**：根据页面层级使用正确的相对路径
3. **错误处理**：添加适当的错误处理机制
4. **性能优化**：避免重复加载菜单组件

## 检查清单

在添加新页面或修改现有页面时，请确认：

- [ ] 引用了 `unified-sidebar.css` 样式文件
- [ ] 添加了 `sidebar-container` 容器元素
- [ ] 使用了正确的相对路径加载菜单组件
- [ ] 包含了完整的JavaScript加载脚本
- [ ] 测试菜单功能正常工作

---

**注意**：违反此规范可能导致菜单无法正常显示或功能异常，影响用户体验。如有疑问，请参考现有正确实现的页面。